Lentil Bolognese

INGREDIENTS
2 Tbsp. extra-virgin olive oil
2 oz. bacon or pancetta (Italian bacon), finely chopped (optional)
1 large onion, finely chopped
4 garlic cloves, finely chopped
2 Tbsp. harissa paste or tomato paste
½ cup red wine or dry white wine
1 (28-oz.) can whole peeled or diced tomatoes
2¼ cups Big-Batch Marinated Lentils, divided
Kosher salt, freshly ground pepper
1 lb. dried pasta (any kind)
2 Tbsp. unsalted butter, cut into small pieces
Finely grated Parmesan, (for serving; optional)

PREPARATION
Heat oil and bacon (if using) in a large Dutch oven or other heavy pot over medium, stirring, until bacon starts to sizzle, about 1 minute. Add onion and garlic and cook until onion is translucent, 5–8 minutes. Add harissa paste and cook, stirring occasionally, until slightly darkened in color, about 5 minutes. Add wine and cook, scraping up browned bits and stirring occasionally, until wine is reduced by half, about 3 minutes.
If using whole tomatoes, use kitchen shears or a pairing knife to burst each in the can (this will prevent juice from squirting on your shirt when you crush them). Add to pot, crushing with your hands as you go; add any juices remaining in can. If using diced tomatoes, add directly to pot along with juices. Stir to combine, then fill can almost to the top with water and pour into pot, swirling to get all the extra tomato juices out of the can. Bring sauce to a boil over medium heat.
Set aside ½ cup lentils for serving. Add remaining lentils to sauce. Reduce heat and simmer, stirring occasionally, until sauce thickens slightly and flavors come together, 25–30 minutes. Remove from heat and purée sauce with an immersion blender until almost smooth in some places but chunky in others. (Alternatively, purée half of sauce in a blender until almost smooth, then stir back into sauce in pot.) Season with salt and pepper. Keep warm until ready to serve.
Cook pasta in a large pot of boiling salted water until not quite al dente, about 1 minute less than package directions.
Using a spider or tongs, transfer pasta to sauce and add butter and ½ cup pasta cooking liquid. Cook, stirring constantly and adding more pasta cooking liquid if needed, until sauce thickens enough to coat pasta and pasta looks glossy, about 1 minute.
Divide pasta among shallow bowls and top with reserved lentils and Parmesan (if using).
Do ahead: Sauce can be made 5 days ahead. Let cool, then transfer to an airtight container. Cover and chill, or freeze up to 3 months. Reheat, adding a little water to thin if needed, before serving.