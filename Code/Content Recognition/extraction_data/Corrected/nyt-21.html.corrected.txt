Pasta e Ceci (Italian Pasta and Chickpea Stew)

INGREDIENTS
3  tablespoons olive oil, plus more for drizzling
1  medium yellow onion, finely chopped
3  garlic cloves, finely chopped
2  teaspoons chopped fresh rosemary
Â½  teaspoon red-pepper flakes
 Kosher salt and black pepper
1  packed cup canned whole tomatoes, drained
1  (15-ounce) can chickpeas, rinsed
1  cup ditalini
4  cups roughly chopped escarole, Tuscan kale or radicchio
 Grated pecorino, for serving

PREPARATION
Heat the oil in a large stock pot or Dutch oven over medium. Add the onion and cook, stirring occasionally, until softened but not taking on any color, 4 to 5 minutes. Add the garlic, rosemary and red-pepper flakes, and cook 1 minute more. Season well with salt and pepper.
Stir in the tomatoes and the chickpeas, breaking up the tomatoes with the back of a spoon or spatula and smashing about 1/2 cup of the beans.
Add 3 cups water and bring to a boil over high. Add the pasta and simmer, stirring often to make sure nothing sticks to the bottom of the pan, until the pasta is al dente, about 10 minutes. The water will mostly be absorbed by the pasta, but if you prefer it brothier, you can add 1/2 to 1 cup water and simmer until warmed through, 1 minute more. Season to taste with salt and pepper.
Add the escarole and stir until wilted. Taste and adjust seasonings accordingly. Ladle into bowls and top with grated cheese and a drizzle of olive oil.